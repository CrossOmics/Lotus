2025-11-23 21:34:23,068 - INFO - Logging initialized. Log file: result_20251123_213423/workflow_20251123_213423.log
2025-11-23 21:34:23,068 - INFO - ============================================================
2025-11-23 21:34:23,069 - INFO - Lotus Workflow - Starting Analysis
2025-11-23 21:34:23,069 - INFO - ============================================================
2025-11-23 21:34:23,071 - INFO - Generated AnnData with shape (180, 50) and 50 genes.
2025-11-23 21:34:23,072 - INFO - 
============================================================
2025-11-23 21:34:23,072 - INFO - Preprocessing Pipeline
2025-11-23 21:34:23,072 - INFO - ============================================================
2025-11-23 21:34:23,072 - INFO - Running complete preprocessing pipeline...
2025-11-23 21:34:26,974 - INFO - ✓ Preprocessing complete
2025-11-23 21:34:26,975 - INFO -   - Data shape: (180, 50)
2025-11-23 21:34:26,975 - INFO -   - PCA stored in: `adata.obsm['X_pca']` (shape: (180, 20))
2025-11-23 21:34:26,975 - INFO -   - Latent representation stored in: `adata.obsm['X_latent']` (shape: (180, 32))
2025-11-23 21:34:26,975 - INFO -   - Raw counts saved in: `adata.layers['raw_counts']`
2025-11-23 21:34:26,975 - INFO -   - Neighbors graph constructed: True
2025-11-23 21:34:26,975 - INFO - 
============================================================
2025-11-23 21:34:26,976 - INFO - Clustering
2025-11-23 21:34:26,976 - INFO - ============================================================
2025-11-23 21:34:26,976 - INFO - Performing clustering analysis...
2025-11-23 21:34:32,968 - INFO - ✓ Clustering complete
2025-11-23 21:34:32,968 - INFO -   - Cluster labels stored in: `adata.obs['cplearn_labels']`
2025-11-23 21:34:32,968 - INFO -   - Number of clusters: 3
2025-11-23 21:34:32,968 - INFO -   - Cluster IDs: [0, 1, 2]
2025-11-23 21:34:32,968 - INFO - 
============================================================
2025-11-23 21:34:32,969 - INFO - Visualization: UMAP
2025-11-23 21:34:32,969 - INFO - ============================================================
2025-11-23 21:34:32,969 - INFO - Computing UMAP embedding and generating visualization...
2025-11-23 21:34:33,763 - INFO - ✓ UMAP visualization complete
2025-11-23 21:34:33,763 - INFO -   - UMAP embedding stored in: `adata.obsm['X_umap']` (shape: (180, 2))
2025-11-23 21:34:33,763 - INFO -   - Visualization saved to: result_20251123_213423/umap_clusters.png
2025-11-23 21:34:33,763 - INFO - 
============================================================
2025-11-23 21:34:33,763 - INFO - CoreAnalysis: Core map embedding and core layer extraction
2025-11-23 21:34:33,764 - INFO - ============================================================
2025-11-23 21:34:33,764 - INFO - Computing core map embedding...
2025-11-23 21:34:35,548 - INFO - ✓ CoreAnalysis complete
2025-11-23 21:34:35,548 - INFO -   - Core map embedding stored in: `adata.obsm['X_cplearn_coremap']` (shape: (180, 32))
2025-11-23 21:34:35,548 - INFO -   - Assigned points: 180/180 (100.0%)
2025-11-23 21:34:35,548 - INFO - 
============================================================
2025-11-23 21:34:35,549 - INFO - DEG: Marker Genes
2025-11-23 21:34:35,549 - INFO - ============================================================
2025-11-23 21:34:35,549 - INFO - Identifying differentially expressed genes (marker genes)...
2025-11-23 21:34:35,568 - INFO - ✓ DEG analysis complete
2025-11-23 21:34:35,569 - INFO -   - Total differentially expressed genes: 50
2025-11-23 21:34:35,569 - INFO -   - Significant genes (p_adj < 0.05): 41
2025-11-23 21:34:35,569 - INFO -   - Significant genes (p_adj < 0.01): 39
2025-11-23 21:34:35,569 - INFO - 
Top 10 differentially expressed genes:
2025-11-23 21:34:35,572 - INFO - 
    gene   log2fc   z_score       pvalue        p_adj   mean_a   mean_b  pct_expr_a  pct_expr_b
gene_002 2.187279 18.400315 2.021035e-20 3.368391e-19 6.666667 0.683333    1.000000    0.500000
gene_027 2.102686 19.505699 4.567841e-21 1.170854e-19 7.733333 1.033333    1.000000    0.600000
gene_021 2.078502 16.554285 4.683415e-21 1.170854e-19 9.700000 1.533333    1.000000    0.733333
gene_029 1.939962 12.955106 7.978928e-18 4.432738e-17 4.883333 0.533333    0.966667    0.366667
gene_032 1.911840 13.144602 6.643614e-18 4.152259e-17 5.083333 0.616667    0.966667    0.433333
gene_031 1.902821 15.913483 3.142358e-20 3.927948e-19 7.850000 1.366667    1.000000    0.750000
gene_045 1.866375 14.216678 6.965233e-19 4.975166e-18 6.900000 1.166667    1.000000    0.716667
gene_004 1.847075 14.939477 2.073976e-19 1.728313e-18 4.216667 0.450000    0.983333    0.350000
gene_023 1.603167 10.278753 1.255096e-15 4.827291e-15 4.316667 0.750000    0.983333    0.500000
gene_044 1.584963 12.506953 1.768928e-17 8.040582e-17 5.950000 1.316667    1.000000    0.666667
2025-11-23 21:34:35,574 - INFO -   - DEG results saved to: result_20251123_213423/deg_results.csv
2025-11-23 21:34:35,575 - INFO - 
============================================================
2025-11-23 21:34:35,575 - INFO - Visualization: Rendering all visualizations
2025-11-23 21:34:35,575 - INFO - ============================================================
2025-11-23 21:34:36,224 - INFO -   - Moved umap_clusters.png to output directory
2025-11-23 21:34:36,226 - INFO -   - Moved violin_markers.png to output directory
2025-11-23 21:34:36,226 - INFO - ✓ All visualizations complete
2025-11-23 21:34:36,226 - INFO -   - UMAP clusters plot: result_20251123_213423/umap_clusters.png
2025-11-23 21:34:36,226 - INFO -   - Marker genes violin plot: result_20251123_213423/violin_markers.png
2025-11-23 21:34:36,226 - INFO -   - Top 5 marker genes visualized: gene_002, gene_027, gene_021, gene_029, gene_032
2025-11-23 21:34:36,227 - INFO - 
============================================================
2025-11-23 21:34:36,227 - INFO - Workflow Summary
2025-11-23 21:34:36,227 - INFO - ============================================================
2025-11-23 21:34:36,227 - INFO - ✓ All results saved to: /mnt/d/lotus/examples/result_20251123_213423
2025-11-23 21:34:36,227 - INFO - ✓ Output directory: result_20251123_213423
2025-11-23 21:34:36,228 - INFO -   - Log file: result_20251123_213423/workflow_20251123_213423.log
2025-11-23 21:34:36,228 - INFO -   - DEG results: result_20251123_213423/deg_results.csv
2025-11-23 21:34:36,229 - INFO -   - UMAP plot: result_20251123_213423/umap_clusters.png
2025-11-23 21:34:36,229 - INFO -   - Violin plot: result_20251123_213423/violin_markers.png
2025-11-23 21:34:36,229 - INFO - ============================================================
2025-11-23 21:34:36,229 - INFO - Workflow completed successfully!
2025-11-23 21:34:36,229 - INFO - ============================================================
